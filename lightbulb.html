<!DOCTYPE html>
<html lang="en">

<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, height=device-height, initial-scale=1.0">
	<meta http-equiv="X-UA-Compatible" content="ie=edge">
	<title>Lightbulb</title>

</head>

<body style="margin: 0;" id="body">
	<canvas style="margin: 0;" id="canvas"></canvas>
	<script>
		let w = window.innerWidth;
		let h = window.innerHeight;
		canvas = document.getElementById("canvas");
		var ctx = canvas.getContext("2d");
		canvas.width = w - 8;
		canvas.height = h - 8;
		let x = 255;
		let y = 255;
		let z = 255;
		let mousedown = false;
		document.getElementById("body").addEventListener("mousedown", handleMouseDown);
		document.getElementById("body").addEventListener("mouseup", handleMouseUp);
		document.getElementById("body").addEventListener("mousemove", handleMouseMove);
		let mouseX = 0;
		let mouseY = 0;
		function handleMouseDown() {
			mousedown = true;
			setcolor();
		}
		function handleMouseUp() {
			mousedown = false;
		}
		function handleMouseMove(event) {
			mouseX = event.clientX;
			mouseY = event.clientY;
			if (mousedown) {
				setcolor();
			}
		}
		function setcolor() {
			if ((mouseX / w) < 0.5) {
				x = 40 + (60 - 40) * (2 * mouseX / w);
				y = 100 + (0 - 100) * (2 * mouseX / w);
				z = 100 + (0-100) * (mouseY / h);
			} else {
				x = 180 + (200 - 180) * (2 * mouseX / w - 1);
				y = 0 + (100 - 0) * (2 * mouseX / w - 1);
				z = 100 + (0-100) * (mouseY / h);
			}
			let hsl = hsl2rgb(x,y,z);
			ctx.fillStyle = "rgb(" + hsl[0] + "," + hsl[1] + "," + hsl[2] + ")";
			ctx.fillRect(0, 0, canvas.width + 10, canvas.height + 10);
		}
		function hsvR(h, s, v) {

		}
		function hsvG(h, s, v) {

		}
		function hsvB(h, s, v) {

		}
		// input: h as an angle in [0,360] and s,l in [0,1] - output: r,g,b in [0,1]
		function hsl2rgb(h, s, l) {
			s = s/100;
			l = l/100;
			let a = s * Math.min(l, 1 - l);
			let f = (n, k = (n + h / 30) % 12) => l - a * Math.max(Math.min(k - 3, 9 - k, 1), -1);
			return [255*f(0), 255*f(8), 255*f(4)];
		}
	</script>
</body>

</html>